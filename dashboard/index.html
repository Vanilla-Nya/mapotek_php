<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Mapotek Estetik - New Layout V2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* Variabel Warna Gradasi (Sama) */
        :root {
            --gradient-start: #7f53ac; /* Ungu sedang */
            --gradient-end: #647dee;   /* Biru sedang */
            --gradient-angle: 135deg;  /* Sudut gradasi */
        }

        /* CSS Kustom */
        body { 
            background-color: #f8f9fa; 
            color: #333;
            min-height: 100vh;
        }
        
        .main-content {
            width: 100%; 
            padding: 0; 
        }

        /* 1. WELCOME CARD */
        .header-welcome { 
            min-height: 250px; 
            padding: 60px 20px; 
            margin-bottom: 30px; 
            color: white; 
            text-shadow: 2px 2px 6px rgba(0,0,0,0.7);
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('try2.jpg') center center / cover no-repeat;
            border-radius: 0 0 25px 25px;
            display: flex;
            align-items: center;
        }
        .header-welcome h5 { 
            font-size: 2.5rem; 
            font-weight: 700;
        }
        .header-welcome p {
            font-size: 1.2rem;
            opacity: 0.8;
        }

        /* 2. GRADIENT CARD untuk Obat */
        .card-gradient-blue-purple {
            background: linear-gradient(var(--gradient-angle), var(--gradient-start), var(--gradient-end));
            color: white;
            border: none;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2); 
            border-radius: 1rem; 
        }

        /* 3. Style Kartu Ringkasan Obat */
        .card-ringkasan { 
            height: 180px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            font-weight: bold; 
            padding: 20px;
        }
        .card-ringkasan .top-content {
            display: flex;
            align-items: center;
            gap: 15px; 
            margin-bottom: 10px; 
        }
        .card-ringkasan .count {
            font-size: 5rem; 
            line-height: 1; 
            letter-spacing: -2px;
        }
        .card-ringkasan i {
            font-size: 4rem; 
            line-height: 1; 
            color: rgba(255, 255, 255, 0.9);
        }
        .card-ringkasan small {
            color: rgba(255, 255, 255, 1);
            font-size: 1.2rem; 
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* 4. Style untuk Kartu Grafik yang dapat di-toggle (Flip Card) */
        .chart-toggle-card {
            /* Tinggi Ditingkatkan (dari 400px menjadi 500px) */
            min-height: 500px; 
            position: relative;
            transition: transform 0.8s; 
            transform-style: preserve-3d;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 0.5rem; 
            margin-bottom: 30px; 
        }
        
        .chart-face {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            border-radius: inherit; 
            background-color: white;
            border: 1px solid #dee2e6;
        }
        /* Tinggi Canvas Grafik disesuaikan agar chart lebih tinggi */
        .card-back .flex-grow-1 {
            height: 400px; /* Ditingkatkan dari 300px */
            position: relative;
        }
        
        /* ... Gaya Flip Card lainnya tetap sama ... */

        .chart-toggle-btn {
            cursor: pointer;
            color: var(--gradient-end); 
            font-weight: 500;
        }

        /* 5. Card Antrian dan QR */
        .qr-antrian-card {
            background: linear-gradient(var(--gradient-angle), var(--gradient-end), var(--gradient-start)); 
            color: white;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 0.5rem; 
        }
        .qr-antrian-card img {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
        }
        /* Card Pembungkus Tabel Antrian */
        .card-antrian-gradient {
            background: linear-gradient(var(--gradient-angle), var(--gradient-start), var(--gradient-end));
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 0.5rem;
        }
        /* ... Gaya Tabel Antrian lainnya tetap sama ... */
        .antrian-list-container {
            max-height: 500px; 
            overflow-y: auto; 
        }
    </style>
</head>
<body>
    
    <div class="main-content">
        
        <div class="header-welcome shadow-lg">
            <div class="container-fluid">
                <h5 class="mb-0">Selamat Datang, Dr. Vanilla!</h5>
                <p class="text-white mb-0">God Always Bless You, Have a Good Day</p>
            </div>
        </div>
        
        <div class="container-fluid">
            
            <div class="row g-4 mb-5">
                <div class="col-md-6">
                    <div class="card card-gradient-blue-purple text-center">
                        <div class="card-ringkasan">
                            <div class="top-content">
                                <i class="fas fa-calendar-times"></i> 
                                <span class="count" id="obatExpired">10</span>
                            </div>
                            <small>OBAT EXPIRED</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card card-gradient-blue-purple text-center">
                        <div class="card-ringkasan">
                            <div class="top-content">
                                <i class="fas fa-boxes"></i> 
                                <span class="count" id="obatHabis">4</span>
                            </div>
                            <small>OBAT HABIS</small>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row g-3 mb-5">
                <div class="col-12">
                     <div class="card shadow-sm p-0 chart-toggle-card" id="financeCard">
                        <div class="card-front chart-face active p-4">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h5 class="card-title fw-bold mb-0">Ringkasan Keuangan (Bulan Ini)</h5>
                                <span class="chart-toggle-btn" data-target="chart-back">
                                    <i class="fas fa-chart-bar me-1"></i> Lihat Grafik
                                </span>
                            </div>
                            <div class="row text-center my-auto align-items-center flex-grow-1">
                                <div class="col-md-6 my-2">
                                    <div class="p-4 bg-success text-white rounded shadow-sm">
                                        <small class="d-block">Total Pemasukan</small>
                                        <h2 class="fw-bold mb-0">Rp 32.500.000</h2> 
                                    </div>
                                </div>
                                <div class="col-md-6 my-2">
                                    <div class="p-4 bg-danger text-white rounded shadow-sm">
                                        <small class="d-block">Total Pengeluaran</small>
                                        <h2 class="fw-bold mb-0">Rp 7.200.000</h2> 
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card-back chart-face p-4">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h5 class="card-title fw-bold mb-0">Grafik Pemasukan dan Pengeluaran (5 Bulan Terakhir)</h5>
                                <span class="chart-toggle-btn" data-target="chart-front">
                                    <i class="fas fa-undo me-1"></i> Kembali ke Ringkasan
                                </span>
                            </div>
                            <div class="flex-grow-1">
                                <canvas id="incomeExpenseChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="row g-4 mb-4">
                
                <div class="col-lg-8">
                    <div class="card card-antrian-gradient shadow-sm"> 
                        <div class="card-header fw-bold">Jadwal Antrian Hari Ini</div>
                        <div class="card-body p-0 antrian-list-container">
                            <div id="jadwalAntrianHariIni">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card qr-antrian-card shadow-sm">
                        <div class="card-body text-center p-4">
                            <h6 class="text-uppercase mb-3">Scan QR Antrian</h6>
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=MapotekAntrian" alt="QR Code Antrian" class="img-fluid border p-2">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- DATA INPUT GRAFIK (DIUBAH KE 5 BULAN) ---
            const labelsBulan = ['Mar', 'Apr', 'Mei', 'Jun', 'Jul']; // 5 Bulan
            const dataPemasukan = [2000000, 6000000, 5500000, 4000000, 7500000]; // 5 Data
            const dataPengeluaran = [1200000, 700000, 900000, 1500000, 1100000]; // 5 Data

            // --- FUNGSI CHART.JS ---
            const ctx = document.getElementById('incomeExpenseChart');
            if(ctx) {
                 new Chart(ctx, {
                    type: 'bar', 
                    data: {
                        labels: labelsBulan,
                        datasets: [
                            {
                                label: 'Pemasukan',
                                data: dataPemasukan, 
                                backgroundColor: 'rgba(40, 167, 69, 0.8)',
                                borderColor: 'rgba(40, 167, 69, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Pengeluaran',
                                data: dataPengeluaran,
                                backgroundColor: 'rgba(220, 53, 69, 0.8)',
                                borderColor: 'rgba(220, 53, 69, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value, index, ticks) {
                                        if (value >= 1000000) {
                                            return 'Rp ' + (value / 1000000).toFixed(1) + ' Jt';
                                        } else if (value >= 1000) {
                                            return 'Rp ' + (value / 1000) + ' Rb';
                                        }
                                        return 'Rp ' + value;
                                    }
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        }
                    }
                });
            }
            
            // --- FUNGSI TOGGLE GRAFIK (FLIP CARD) ---
            document.querySelectorAll('.chart-toggle-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const financeCard = document.getElementById('financeCard');
                    const target = this.getAttribute('data-target');

                    // Menggunakan kelas 'flipped' untuk trigger transformasi 3D
                    financeCard.classList.toggle('flipped');

                    // Mengatur visibility face yang aktif
                    const cardFront = financeCard.querySelector('.card-front');
                    const cardBack = financeCard.querySelector('.card-back');

                    if (financeCard.classList.contains('flipped')) {
                        // Tampilkan Back (Grafik)
                        setTimeout(() => {
                             cardFront.style.display = 'none';
                             cardBack.style.display = 'flex';
                        }, 400); // Tunggu setengah animasi flip
                    } else {
                        // Tampilkan Front (Ringkasan)
                        cardFront.style.display = 'flex';
                        cardBack.style.display = 'none';
                    }
                });
            });


            // --- FUNGSI JADWAL ANTRIAN HARI INI (Data tetap, hanya untuk demo) ---
            const jadwalHariIniContainer = document.getElementById('jadwalAntrianHariIni');
            const jadwalHariIniData = [
                { no: 1, nama: "Adelia", waktu: "09:00", status: "Dipanggil" },
                { no: 2, nama: "Herawati", waktu: "09:30", status: "Menunggu" },
                { no: 3, nama: "Alfon", waktu: "10:00", status: "Menunggu" },
                { no: 4, nama: "Aldi", waktu: "10:30", status: "Menunggu" },
                { no: 5, nama: "Budi", waktu: "11:00", status: "Menunggu" },
                { no: 6, nama: "Citra", waktu: "11:30", status: "Menunggu" },
                { no: 7, nama: "Dian", waktu: "12:00", status: "Menunggu" },
                { no: 8, nama: "Eko", waktu: "12:30", status: "Menunggu" },
                { no: 9, nama: "Fani", waktu: "13:00", status: "Menunggu" },
                { no: 10, nama: "Gita", waktu: "13:30", status: "Menunggu" }
            ];

            let tableHTML = `
                <div class="table-responsive">
                    <table class="table table-striped table-hover mb-0">
                        <thead class="sticky-top bg-light">
                            <tr>
                                <th scope="col" class="text-center">No.</th>
                                <th scope="col">Nama Pasien</th>
                                <th scope="col">Waktu</th>
                                <th scope="col" class="text-center">Status</th>
                                <th scope="col">Aksi</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            jadwalHariIniData.forEach(pasien => {
                let statusBadgeClass;
                if (pasien.status === 'Menunggu') statusBadgeClass = 'bg-warning text-dark';
                else if (pasien.status === 'Dipanggil') statusBadgeClass = 'bg-primary';
                else if (pasien.status === 'Selesai') statusBadgeClass = 'bg-success';
                else statusBadgeClass = 'bg-danger';

                tableHTML += `
                    <tr>
                        <td class="text-center">${pasien.no}</td>
                        <td>${pasien.nama}</td>
                        <td>${pasien.waktu}</td>
                        <td class="text-center"><span class="badge ${statusBadgeClass} py-2">${pasien.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline-secondary me-1" title="Lihat Detail"><i class="fas fa-eye"></i></button>
                            <button class="btn btn-sm btn-outline-danger" title="Batalkan"><i class="fas fa-times"></i></button>
                        </td>
                    </tr>
                `;
            });

            tableHTML += `
                        </tbody>
                    </table>
                </div>
            `;

            jadwalHariIniContainer.innerHTML = tableHTML;
        });
    </script>
</body>
</html>